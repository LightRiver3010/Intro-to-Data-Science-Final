#Testing File

library(tidyverse)
library(ggplot2)
install.packages("gganimate")
library(gganimate)
theme_set(theme_bw())
install.packages("Lahman")
library(Lahman)
install.packages("gifski")
library(gifski)
install.packages("gapminder")
library(gapminder)
head(gapminder)
library(palmerpenguins)

#Testing Animated Graphs

#1 - Animated Scatter Plot
p <- ggplot(
  gapminder,
  aes(x= gdpPercap, y=lifeExp, size=pop, color=country) 
) +
  geom_point(show.legend=FALSE, alpha=0.7) +
  scale_color_viridis_d() +
  scale_size(range=c(2,12)) +
  scale_x_log10() +
  labs(x="GDP per capital", y="Life expectancy") +
  transition_time(year) +
  labs(title = "Year: {frame_time}") +
  ease_aes('linear') +
  shadow_wake(wake_length = 0.1, alpha =FALSE)

animate(p, renderer = gifski_renderer())

df <- gapminder
df

df1 <- df |>
  filter(continent == 'Asia')

afg <- df1 |>
  filter(country == 'Afghanistan')

#2 - Animated Line Graph
g <- ggplot(
  df1,
  aes(x=year, y=lifeExp, group = country)
  ) +
  geom_line() +
  scale_color_viridis_b() +
  labs(x= "Year", y= "Life Expectancy") +
  geom_point() +
  transition_reveal(year)

g


#Making my own with Penguins
penguins <- palmerpenguins::penguins
penguins

y <- ggplot(
  penguins,
  aes(flipper_length_mm, body_mass_g, color=bill_depth_mm) 
) +
  geom_point() +
  transition_time(flipper_length_mm) +
  ease_aes('linear')

animate(y, renderer = gifski_renderer())

y







#Actual Coding File

library(tidyverse)
library(ggplot2)
install.packages("gganimate")
library(gganimate)
theme_set(theme_bw())
install.packages("Lahman")
library(Lahman)
install.packages("gifski")
library(gifski)
install.packages("readxl")
library("readxl")

#Importing the data
df <- read_excel("C:/Users/jsavaryn/Downloads/IndiaDepressionV2.xlsx")
glimpse(df)
#Fixing up some columns 
df <- rename(df, 'Student Id' = 'id')
glimpse(df)
colnames(df)
df$`Work/Study Hours`
df <- as.numeric(dataframe$'Work/Study')
df <- as.numeric(dataframe$Region)
glimpse(df)
bang <- df |>
  filter(City == 'Bangalore')
bang

df <- df |>
  filter(CGPA > 4.5)

#Making animated graphs
p1 <- ggplot(
  bang,
  aes(x= CGPA, y=`Work/Study Hours`, group = `Suicidal throughts present?`) 
) +
  geom_line() +
  scale_color_viridis_d() +
  #scale_size(range=c(2,12)) +
  #scale_x_log10() +
  labs(x="GPA", y="Study Hours") +
  transition_time(Age) +
  labs(title = "Age: {frame_time}") 
animate(p1, renderer = gifski_renderer())


p2 <- ggplot(bang, aes(x=`Work/Study Hours`, y=Age)) +
  geom_col() +
  scale_fill_distiller(palette = "Reds", direction = 1) +
  theme_minimal() 
p2

#Plot 1
bang |>
  select(Age, Depression, `Academic Pressure`) |>
  ggplot(aes(x=Depression, y=`Academic Pressure`)) +
  geom_tile(aes(fill=Age))

#Plot 1.5
df |>
  filter(CGPA>2.5) |>
  ggplot(aes(CGPA, `Work/Study Hours`)) +
  geom_tile(aes(fill=Age), linewidth = 10.5)

#Plot 2
df |>
  filter(State=='Punjab') |>
  ggplot(aes(CGPA, `Work/Study Hours`, size=Age)) +
  geom_point()

ggplot(df, aes())


#Plot 3
ggplot(df, aes(x=CGPA)) +
  geom_histogram(binwidth=1)
